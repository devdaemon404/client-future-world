<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FW HRIS <%= name %></title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.5.207/build/pdf.min.js" crossorigin="anonymous" /> -->
</head>

<body class="container">
  <style>
    table.greyGridTable {
      border: 1px solid black;
      width: 100%;
      text-align: left;
      border-collapse: collapse;
    }

    table.greyGridTable td,
    table.greyGridTable th {
      border: 1px solid black;
      padding: 3px;
    }

    table.greyGridTable tbody td {
      font-size: 13px;
    }

    table.greyGridTable thead {
      background: #ffffff;
      border: 1px solid #333333;
    }

    table.greyGridTable thead th {
      font-size: 15px;
      font-weight: bold;
      color: #333333;
      text-align: center;
      border: 2px solid #333333;
    }

    table.greyGridTable thead th:first-child {
      border-left: none;
    }

    table.greyGridTable tfoot td {
      font-size: 14px;
    }
  </style>
  <script>
    function onPrint() {
      document.querySelector('#printbtn').style.opacity = 0;
      window.print();
      setTimeout(() => {
        document.querySelector('#printbtn').style.opacity = 1;
      }, 100);
    }
  </script>
  <div>
    <button id="printbtn" onclick="onPrint()" style="float: right; margin: 10px 10px" class="btn btn-info">
      Print
    </button>
    <table class="greyGridTable">
      <thead>
        <tr>
          <td style="border: 0px;">
            <div style="
                  display: flex;
                  align-items: center;
                ">
              <img height="150px" width="auto" style="margin: 10px" src="<%= photo %> " />
          </td>
          <td style="border: 0px;">
            <h1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Future World</h1><br />
            <h6>HUMAN RESOURCE INFORMATION SYSTEM (HRIS)</h6>
  </div>
  </td>
  </tr>
  <tr>
    <th colspan="2">BASIC INFORMATION</th>
  </tr>
  </thead>
  <tbody>
    <% for(let [label,value] of Object.entries(basicInformation || {})){
          %>
    <tr>
      <td style="font-weight: bold"><%= label %></td>
      <td><%= value %></td>
    </tr>
    <%} %>
  </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="2">ADDRESS INFORMATION</th>
      </tr>
    </thead>
    <tbody>
      <% for(let [label,value] of Object.entries(addressInformation || {})){
          %>
      <tr>
        <td style="font-weight: bold"><%= label %></td>
        <td><%= value %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="5">FAMILY MEMBERS INFORMATION</th>
      </tr>
      <tr>
        <th>Name of Member</th>
        <th>Member DOB</th>
        <th>Relationship</th>
        <th>Occupation</th>
        <th>Blood Group</th>
      </tr>
    </thead>
    <tbody>
      <% for(let obj of familyMembersInformation){ %>
      <tr>
        <td><%= obj.name%></td>
        <td><%= obj.dob%></td>
        <td><%= obj.relationship%></td>
        <td><%= obj.occupation%></td>
        <td><%= obj.bloodGroup%></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="2">LANGUAGE INFORMATION</th>
      </tr>
    </thead>
    <tbody>
      <% for(let [label,value] of Object.entries(languageInformation|| {})){
          %>
      <tr>
        <td style="font-weight: bold"><%= label %></td>
        <td><%= value %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="9">
          ACADEMIC INFORMATION<br />
          <span style="font-size: small">(Please specify from Seconday Education onwards & attach a
            Xerox copy of all relavent documents)</span>
        </th>
      </tr>
      <tr>
        <th>Qualification Description</th>
        <th>Subject / Specialisation</th>
        <th>Name of School / College / Institute</th>
        <th>Marks %</th>
        <th>Year of Passing</th>
      </tr>
    </thead>
    <tbody>
      <% for(let obj of academicInformation){ %>
      <tr>
        <td><%= obj.qualification %></td>
        <td><%= obj.subject %></td>
        <td><%= obj.schoolName %></td>
        <td><%= obj.marks %></td>
        <td><%= obj.yearOfPassing %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="7">PREFESSIONAL EXPERIENCE</th>
      </tr>
      <tr>
        <th>Company</th>
        <th>From Date</th>
        <th>To Date</th>
        <th>Designation</th>
        <th>Salary p.a.</th>
        <th>Type of Industry</th>
        <th>Reason for leaving</th>
      </tr>
    </thead>
    <tbody>
      <% for(let obj of professionalExperience ){ %>
      <tr>
        <td><%= obj.company %></td>
        <td><%= obj.fromDate %></td>
        <td><%= obj.toDate %></td>
        <td><%= obj.designation %></td>
        <td><%= obj.salary %></td>
        <td><%= obj.typeOfIndustry %></td>
        <td><%= obj.reasonForLeaving %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="5">HEALTH INFORMATION</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <% for(let [label,value] of Object.entries(healthInformation ||
            {})){ %>
        <td>
          <span style="font-weight: bold"><%= label %></span>:&nbsp; <%=
              value %>
        </td>
        <%} %>
      </tr>
    </tbody>
  </table>
  <table class="greyGridTable">
    <tbody>
      <% for(let [label,value] of Object.entries(otherHealthInformation ||
          {})){ %>
      <tr>
        <td style="font-weight: bold"><%= label %></td>
        <td><%= value %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  <hr />
  <table class="greyGridTable">
    <thead>
      <tr>
        <th colspan="2">OTHER INFORMATION</th>
      </tr>
    </thead>
    <tbody>
      <% for(let [label,value] of Object.entries(otherInformation || {})){
          %>
      <tr>
        <td style="font-weight: bold"><%= label %></td>
        <td><%= value %></td>
      </tr>
      <%} %>
    </tbody>
  </table>
  </div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/1.8.349/pdf.min.js"></script>
<script>
  (async () => {

  const drawPdf = async (pdfUrl) => {
    const loadingTask = PDFJS.getDocument(pdfUrl);
    const pdf = await loadingTask.promise;

    // Load information from the first page.
    let canvas;
    for (let i = 1; i <= pdf.numPages; i++) {
      canvas = document.createElement('canvas');
      canvas.setAttribute("id", `canvas${i}`);
      document.body.appendChild(canvas);
      const page = await pdf.getPage(i);
      const scale = 1;
      const viewport = page.getViewport(scale);

      // Apply page dimensions to the <canvas> element.
      // const canvas = document.getElementById("pdf");
      const context = canvas.getContext("2d");
      canvas.height = viewport.height;
      canvas.width = viewport.width;

      // Render the page into the <canvas> element.
      const renderContext = {
        canvasContext: context,
        viewport: viewport
      };
      await page.render(renderContext);
      console.log("Page rendered!" + i);
    }
  };
  const pdfs = '<%= pdf %>';
  console.log('PDFs', (pdfs))
  for(let url of pdfs.split('@@@')) {
    const pdfUrl = url.replaceAll('&amp;','&')
    console.log(pdfUrl)
    await drawPdf(pdfUrl)
  }
  })()
  // for(let url of '<%= pdf %>') {
  // }
</script>

</html>